<div class="container" #container>
    <mat-toolbar>
<!--        <button mat-icon-button (click)="onCodenamesClick()">-->
<!--            <span class="material-icons">close</span>-->
<!--            <span class="material-icons">keyboard_backspace</span>-->
<!--        </button>-->

        <button mat-button color="primary" (click)="onCopyGameLinkClick()">Ссылка на игру</button>
        <button mat-button color="accent" (click)="onNewGameClick()">Новая игра</button>

        <div class="delimiter"></div>

        <div class="stat">
            <div class="games-played" *ngIf="game?.gameInChain > 1">{{game?.gameInChain - 1}} сыграно</div>
            <div class="players-online" *ngIf="playersCount > 1">{{playersCount}} он-лайн</div>
            <div class="wait-for-players" *ngIf="playersCount <= 1"> Ждем игроков...</div>
        </div>

        <div><!-- spacer --></div>

        <button class="refresh" mat-icon-button (click)="onRefreshClick()">
            <span class="material-icons">refresh</span>
        </button>

        <div class="score score-blues">
            <span class="mat-h1"><strong>{{game?.blueLeft}}</strong></span>
        </div>

        <div class="score score-reds">
            <span class="mat-h1"><strong>{{game?.redLeft}}</strong></span>
        </div>
    </mat-toolbar>

    <div class="progress">
        <mat-progress-bar mode="indeterminate" *ngIf="loadingInProgress || uncoveringInProgress.size"></mat-progress-bar>
    </div>

    <mat-grid-list cols="5" rowHeight="2:0.9" gutterSize="0.5rem">
        <mat-grid-tile *ngFor="let agent of game.board; let i = index; trackBy: agentId">
            <div class="agent-wrapper">
                <app-agent-card
                    [name]="agent.name"
                    [side]="agent.side"
                    [uncovered]="agent.uncovered"
                    [uncoveringInProgress]="uncoveringInProgress.has(i)"
                    [fontSize]="cardFontSize"
                    (click)="uncoverAgent(i)">
                </app-agent-card>
            </div>
        </mat-grid-tile>
    </mat-grid-list>

    <app-game-flow-panel
        [gameFlowLog$]="gameFlowLog$"
        [gameId]="gameId"
        [playerType]="playerType"
        [moveSide]="game.move?.isInited ? getOppositeSide(game.move?.side) : game.move?.side"></app-game-flow-panel>
</div>
